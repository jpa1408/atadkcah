# models/gold/metrics/data_quality_metrics.yml
version: 2

metrics:
  - name: total_events
    label: Total Events
    description: "Número total de eventos de push procesados"
    model: "{{ ref('data_quality_metrics') }}"
    type: simple
    type_params:
      measure:
        name: total_events
        agg: sum
    timestamp: metric_date
    time_grains: [day, week, month, quarter, year]

  - name: unique_users
    label: Unique Users
    description: "Número de usuarios únicos que realizaron push events"
    model: "{{ ref('data_quality_metrics') }}"
    type: simple
    type_params:
      measure:
        name: unique_users
        agg: sum
    timestamp: metric_date
    time_grains: [day, week, month, quarter, year]

  - name: unique_repositories
    label: Unique Repositories
    description: "Número de repositorios únicos con push events"
    model: "{{ ref('data_quality_metrics') }}"
    type: simple
    type_params:
      measure:
        name: unique_repositories
        agg: sum
    timestamp: metric_date
    time_grains: [day, week, month, quarter, year]

  - name: avg_commits_per_push
    label: Average Commits per Push
    description: "Promedio de commits por evento de push"
    model: "{{ ref('data_quality_metrics') }}"
    type: simple
    type_params:
      measure:
        name: avg_commits_per_push
        agg: sum
    timestamp: metric_date
    time_grains: [day, week, month, quarter, year]

  - name: events_without_commits
    label: Events Without Commits
    description: "Número de eventos de push sin información de commits"
    model: "{{ ref('data_quality_metrics') }}"
    type: simple
    type_params:
      measure:
        name: events_without_commits
        agg: sum
    timestamp: metric_date
    time_grains: [day, week, month, quarter, year]

  - name: events_without_repo_info
    label: Events Without Repository Info
    description: "Número de eventos sin información de repositorio"
    model: "{{ ref('data_quality_metrics') }}"
    type: simple
    type_params:
      measure:
        name: events_without_repo_info
        agg: sum
    timestamp: metric_date
    time_grains: [day, week, month, quarter, year]

  - name: error_rate
    label: Error Rate
    description: "Porcentaje de eventos con errores (sin commits o sin info de repositorio)"
    model: "{{ ref('data_quality_metrics') }}"
    type: simple
    type_params:
      measure:
        name: error_rate
        agg: sum
    timestamp: metric_date
    time_grains: [day, week, month, quarter, year]
